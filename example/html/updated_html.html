<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RDN Fee Scraper Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/dashboard.css" rel="stylesheet">
    <style>
      /* We've removed the summary cards and match containers, so we'll
         keep only the essential styles for the remaining elements */
  
      /* Source styles */
      .my-summary-source {
        background-color: #d1e7dd;
        padding: 3px 8px;
        border-radius: 4px;
        color: #0f5132;
      }
  
      .updates-source {
        background-color: #d1ecf1;
        padding: 3px 8px;
        border-radius: 4px;
        color: #055160;
      }
  
      /* Reference text styles */
      .ref-text {
        max-width: 300px;
        overflow-wrap: break-word;
        font-size: 0.9em;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="/">RDN Fee Scraper</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/">New Scrape</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    
    <div class="container">
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-primary text-white">
              <h3 class="mb-0">Recovery Database Network - Fee Scraper</h3>
            </div>
            <div class="card-body">
              <!-- Add Case ID Form -->
              <div class="row mb-4" id="case-id-form-container" style="display: none;">
                <div class="col-md-6 offset-md-3">
                  <div class="card border-primary">
                    <div class="card-header bg-primary text-white">
                      <h5 class="mb-0">Enter Case ID</h5>
                    </div>
                    <div class="card-body">
                      <form id="caseIdForm">
                        <div class="mb-3">
                          <label for="caseId" class="form-label">Case ID</label>
                          <input type="text" class="form-control" id="caseId" placeholder="Enter RDN case ID number" required="">
                          <div class="form-text">Enter the RDN case ID you want to scrape.</div>
                        </div>
                        <div class="d-grid">
                          <button type="submit" class="btn btn-primary" id="startScrapeBtn" disabled=""><span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Starting...</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
  
              <!-- Status cards (initially hidden) -->
              <div class="row" id="status-cards" style="display: flex;">
                <div class="col-md-4">
                  <div class="card stats-card">
                    <div class="card-body text-center">
                      <h5 class="card-title">Case ID</h5>
                      <p class="card-text" id="case-id">2168756721</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card stats-card">
                    <div class="card-body text-center">
                      <h5 class="card-title">Elapsed Time</h5>
                      <p class="card-text timer" id="timer">00:02:56</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card stats-card">
                    <div class="card-body text-center">
                      <h5 class="card-title">Status</h5>
                      <p class="card-text" id="status"><span class="badge bg-success">Completed</span></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Database Fee Results section has been removed as it's redundant with other fee tables -->
  
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-dark text-white">
              <h4 class="mb-0">Process Log</h4>
            </div>
            <div class="card-body p-0">
              <div id="log-container"><div class="log-info">Starting scrape for case ID: 2168756721</div><div class="log-info">[16:38:21] WebDriver created successfully</div><div class="log-info">[16:38:21] Navigating to login page...</div><div class="log-info">[16:38:23] Entering login credentials...</div><div class="log-info">[16:38:24] Logging in...</div><div class="log-info">[16:38:31] Login successful!</div><div class="log-info">[16:38:31] Login operation took: 10.567s</div><div class="log-info">[16:38:31] Navigating to case 2168756721...</div><div class="log-info">[16:38:34] Successfully navigated to case 2168756721</div><div class="log-info">[16:38:34] Extracting case information...</div><div class="log-info">[16:38:37] Attempting to extract case information using EXACT pattern match</div><div class="log-info">[16:38:37] Found client name using EXACT pattern: Westlake Services</div><div class="log-info">[16:38:37] Found lien holder name using EXACT pattern: Westlake Financial Services</div><div class="log-info">[16:38:37] Attempting to extract repo type using badge element</div><div class="log-info">[16:38:37] Found Involuntary Repo using specific badge-invol class</div><div class="log-info">[16:38:37] Extracted case information - Client: Westlake Services, Lien Holder: Westlake Financial Services, Repo Type: Involuntary Repo</div><div class="log-info">[16:38:37] Case information extraction took: 3.364s</div><div class="log-info">[16:38:37] Case information extracted: Client: Westlake Services, Lien Holder: Westlake Financial Services, Repo Type: Involuntary Repo</div><div class="log-info">[16:38:37] Scanning the page for key fee information...</div><div class="log-info">[16:38:37] Found 2 key fees in the page!</div><div class="log-info">[16:38:37] Key Fee 1: $250.00 - est has been submitted on case...</div><div class="log-info">[16:38:37] Key Fee 2: $250.00 - 
  
  The fee request is for Key F...</div><div class="log-info">[16:38:37] Created key fee update: $250.00 - Source: Case Page</div><div class="log-info">[16:38:37] Created key fee update: $250.00 - Source: Case Page</div><div class="log-info">[16:38:37] Starting automatic database fee lookup with case information...</div><div class="log-info">[16:38:37] Auto-fetching fee data from database using case information:</div><div class="log-info">[16:38:37] Client: Westlake Services</div><div class="log-info">[16:38:37] Lienholder: Westlake Financial Services</div><div class="log-info">[16:38:37] Repo Type: Involuntary Repo</div><div class="log-info">[16:38:37] Fetching fee data from Azure SQL Database...</div><div class="log-info">[16:38:41] Searching database with: Client=Westlake Services, Lienholder=Westlake Financial Services, FeeType=Involuntary Repo</div><div class="log-info">[16:38:41] Executing ORIGINAL query with parameters: '%Westlake Services%' (str), '%Westlake Financial Services%' (str), '%Involuntary Repo%' (str)</div><div class="log-info">[16:38:41] Searching database for: Client='Westlake Services', Lienholder='Westlake Financial Services', FeeType='Involuntary Repo'</div><div class="log-info">[16:38:41] No results found with lienholder 'Westlake Financial Services'. Trying with 'Standard' lienholder...</div><div class="log-info">[16:38:41] Found 'Standard' lienholder with ID: 201</div><div class="log-info">[16:38:41] Executing FALLBACK STANDARD query with parameters: 201 (int), '%Westlake Services%' (str), '%Involuntary Repo%' (str)</div><div class="log-info">[16:38:41] Falling back to 'Standard' lienholder with parameters: Client='Westlake Services', FeeType='Involuntary Repo'</div><div class="log-info">[16:38:41] Found 1 records with 'Standard' lienholder</div><div class="log-warning"><strong>⚠️</strong> No specific fee data found for lienholder 'Westlake Financial Services'. Using Standard fee amounts instead.</div><div class="log-info">[16:38:41] Successfully fetched 1 total fee records from database</div><div class="log-info">[16:38:42] Successfully fetched 1 matching fee records from database</div><div class="log-info">[16:38:42] Fee 1: Involuntary Repo - $385.00 (Westlake Services)</div><div class="log-error">[16:38:42] Error during automatic database lookup: Object of type Decimal is not JSON serializable</div><div class="log-info">[16:38:42] Navigate to case operation took: 10.782s</div><div class="log-info">[16:38:42] Processing My Summary tab...</div><div class="log-info">[16:38:42] Clicking on My Summary tab...</div><div class="log-info">[16:38:42] Already on My Summary tab, no need to click</div><div class="log-info">[16:38:42] Tab check took: 0.026s</div><div class="log-info">[16:38:42] Scraping fee information from My Summary tab...</div><div class="log-info">[16:38:42] Looking for fee information using direct search...</div><div class="log-info">[16:38:42] No fees found with direct search, trying targeted approach...</div><div class="log-info">[16:38:44] Found 'Updates' section with secondary selector</div><div class="log-info">[16:38:44] Found 'Updates' section successfully</div><div class="log-info">[16:39:15] Found 0 update blocks (limited for performance)</div><div class="log-info">[16:39:15] No fees found in Updates section, using direct JavaScript extraction...</div><div class="log-info">[16:39:15] Found recovery date: 25-04-28</div><div class="log-info">[16:39:15] Found 3 fee elements via direct JavaScript</div><div class="log-info">[16:39:15] Found generic fee element: Keys Fee - $250.00 (25-04-28)</div><div class="log-info">[16:39:15] Found generic fee element: Keys Fee - $250.00 (25-04-28)</div><div class="log-info">[16:39:15] Found generic fee element: Keys Fee - $250.00 (25-04-28)</div><div class="log-info">[16:39:15] Found 3 fee entries in My Summary tab</div><div class="log-info">[16:39:15]   - Keys Fee: 250.00 (25-04-28)</div><div class="log-info">[16:39:15]   - Keys Fee: 250.00 (25-04-28)</div><div class="log-info">[16:39:15]   - Keys Fee: 250.00 (25-04-28)</div><div class="log-info">[16:39:15] My Summary tab scraping took: 32.975s</div><div class="log-info">[16:39:15] Processing Updates tab...</div><div class="log-info">[16:39:15] Clicking on Updates tab...</div><div class="log-info">[16:39:46] Found Updates tab with key: 6</div><div class="log-info">[16:39:47] Successfully clicked Updates tab using JavaScript</div><div class="log-info">[16:39:51] Successfully navigated to Updates tab</div><div class="log-info">[16:39:51] Loading all updates - optimized approach...</div><div class="log-info">[16:39:51] Found pagination controls</div><div class="log-info">[16:40:21] Initial number of updates: 0</div><div class="log-info">[16:40:21] Found ALL button by data-page attribute</div><div class="log-info">[16:40:22] Clicked ALL using JavaScript</div><div class="log-info">[16:40:22] Using fast approach for updates loading...</div><div class="log-info">[16:41:22] Current update count: 0</div><div class="log-info">[16:41:22] Update count stable at 0, proceeding anyway</div><div class="log-info">[16:41:22] Reached maximum wait time. Proceeding with currently loaded updates.</div><div class="log-info">[16:41:23] Load all updates operation took: 92.107s</div><div class="log-info">[16:41:23] Updates loading completed</div><div class="log-info">[16:41:23] Scraping updates...</div><div class="log-info">[16:41:23] Checking for Last Two Updates section...</div><div class="log-info">[16:41:23] No updates found in Last Two Updates section, proceeding with main updates tab</div><div class="log-info">[16:41:23] Scraped 4 updates using JavaScript</div><div class="log-info">[16:41:23] Scraped 4 updates</div><div class="log-info">[16:41:23] Extracting fee information from updates...</div><div class="log-info">[16:41:23] Fee information extraction took: 0.009s</div><div class="log-info">[16:41:23] Analyzed 4 updates and found 0 fee-related updates</div><div class="log-warning">[16:41:23] No fees extracted despite having updates - possible pattern mismatch</div><div class="log-info">[16:41:23] Sample update 0 (type: ): 7029944623</div><div class="log-info">[16:41:23] Sample update 1 (type: ): Name
                                 &lt;empty&gt;
                              
  
                                                              
                                      Address
                                      
                                          &nbsp;
                                          4255 TAMARUS ST APT 166
                                          LAS VEGAS, NV 89119
                                      
                                  
                                  
                                      County
                      </div><div class="log-info">[16:41:23] Sample update 2 (type: ): Name
                                 DRN - 04/06/25 15:42
                              
  
                                                              
                                      Address
                                      
                                          &nbsp;
                                          711 E Twain Ave
                                          Las Vegas, NV 89169-4109
                                      
                                  
                                  
                                      Co</div><div class="log-info">[16:41:23] Fee extraction took: 0.025s</div><div class="log-info">[16:41:23] Total scrape_updates_tab operation took: 0.492s</div><div class="log-info">[16:41:23] Combining fee information from My Summary, Updates, and Key Fee tabs...</div><div class="log-info">[16:41:23] Page Key Fees: 2</div><div class="log-info">[16:41:23] My Summary fees: 3, Updates fees: 0, Key Fees: 2</div><div class="log-info">[16:41:23] Combined fee updates: 5</div><div class="log-info">[16:41:23] Generating fees table from combined sources: 5 total fees</div><div class="log-info">[16:41:23] Generating fees table with Azure database fee card handling...</div><div class="log-info">[16:41:23] Looking up repo fee information for client=Westlake Services, lienholder=Westlake Financial Services, fee_type=Involuntary Repo</div><div class="log-info">[16:41:23] Looking up repo fee for: Client="Westlake Services", Lienholder="Westlake Financial Services", FeeType="Involuntary Repo"</div><div class="log-info">[16:41:26] Getting foreign keys from names...</div><div class="log-info">[16:41:27] Executing PRIMARY LOOKUP query with parameters: 100 (int), 1436 (int), 1 (int)</div><div class="log-info">[16:41:27] No specific record found. Looking up 'Standard' lienholder as fallback...</div><div class="log-info">[16:41:27] Executing FALLBACK LOOKUP query with parameters: 100 (int), 201 (int), 1 (int)</div><div class="log-info">[16:41:27] Found fallback fee using 'Standard' lienholder</div><div class="log-info">[16:41:28] Found repo fee in database: $385.00</div><div class="log-info">[16:41:28] Note: Lienholder 'Westlake Financial Services' specific fee not found. Using Standard amount.</div><div class="log-info">[16:41:28] Processing 5 total fees: 3 from My Summary, 2 from Updates, 0 Key Fees, and 1 from Database</div><div class="log-info">[16:41:28] Detected key fee, setting category to 'Other' and keeping 'Keys Fee' in reference</div><div class="log-info">[16:41:28] Matched pre-approved non-repo fee (exact match): original='Other', matched='OTHER'</div><div class="log-info">[16:41:28] Setting key fee display to category 'Other' with reference 'Keys Fee'</div><div class="log-info">[16:41:28] Skipping duplicate fee: $250.00 from My Summary</div><div class="log-info">[16:41:28] Detected key fee, setting category to 'Other' and keeping 'Keys Fee' in reference</div><div class="log-info">[16:41:28] Matched pre-approved non-repo fee (exact match): original='Other', matched='OTHER'</div><div class="log-info">[16:41:28] Setting key fee display to category 'Other' with reference 'Keys Fee'</div><div class="log-info">[16:41:28] Using explicit fee type from pattern: Keys Fee</div><div class="log-info">[16:41:28] Detected key fee, setting category to 'Other' and keeping 'Keys Fee' in reference</div><div class="log-info">[16:41:28] Matched pre-approved non-repo fee (exact match): original='Other', matched='OTHER'</div><div class="log-info">[16:41:28] Setting key fee display to category 'Other' with reference 'Keys Fee'</div><div class="log-info">[16:41:28] Using explicit fee type from pattern: Keys Fee</div><div class="log-info">[16:41:28] Detected key fee, setting category to 'Other' and keeping 'Keys Fee' in reference</div><div class="log-info">[16:41:28] Matched pre-approved non-repo fee (exact match): original='Other', matched='OTHER'</div><div class="log-info">[16:41:28] Setting key fee display to category 'Other' with reference 'Keys Fee'</div><div class="log-info">[16:41:28] Generated fees table with 4 entries (2 from My Summary, 2 from Updates, 1 from Database)</div><div class="log-info">[16:41:28] Sample fee entry: {'date': '25-04-28', 'amount': '$250.00', 'type': 'My Summary Fee', 'approver': '', 'referenceSentence': 'Keys Fee: Details\n\t\t\t\t\t\t\t\t  A new fee request has been submitted on case ID 2168756721\n\nThe fee request is for Key Fee in the amount of $250.00', 'approved': 'Yes', 'category': 'Other', 'source': 'My Summary', 'originalCategory': 'Keys Fee', 'matched': True, 'matchedAs': 'Pre-approved Non-Repo'}</div><div class="log-info">[16:41:28] Fee table generation took: 4.645s</div><div class="log-info">[16:41:28] Saving data to disk...</div><div class="log-info">[16:41:28] Saving raw update data...</div><div class="log-info">[16:41:28] Saving My Summary fee data...</div><div class="log-info">[16:41:28] Saving extracted fee data...</div><div class="log-info">[16:41:28] Saving fee table with 4 fees (2 from My Summary)</div><div class="log-info">[16:41:28] Generating HTML report...</div><div class="log-info">[16:41:28] Generating HTML report with Azure Database Fee Card...</div><div class="log-info">[16:41:28] HTML report generation took: 0.002s</div><div class="log-info">[16:41:28] Scrape completed successfully for case ID: 2168756721</div><div class="log-info">[16:41:28] Total scraping process took: 189.341s</div></div>
            </div>
            <div class="card-footer">
              <div class="progress">
                <div id="progress-bar" class="progress-bar progress-bar-striped" role="progressbar" style="width: 100%;" aria-valuenow="75"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row results-container" id="results-container" style="display: block;">
        <div class="col-12 mb-4">
          <div class="card">
            <div class="card-header bg-info text-white">
              <h4 class="mb-0">Case Information</h4>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-4">
                  <div class="card stats-card">
                    <div class="card-body text-center">
                      <h5 class="card-title">Client Name</h5>
                      <p class="card-text" id="client-name">Westlake Services</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card stats-card">
                    <div class="card-body text-center">
                      <h5 class="card-title">Lien Holder</h5>
                      <p class="card-text" id="lien-holder-name">Westlake Financial Services</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card stats-card">
                    <div class="card-body text-center">
                      <h5 class="card-title">Repo Type</h5>
                      <p class="card-text" id="repo-type">Involuntary Repo</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-success text-white">
              <h4 class="mb-0">Extracted Fees Summary</h4>
            </div>
            <div class="card-body">
              <!-- Summary cards and match summary containers were removed as requested -->
              <!-- Hidden elements to store the data for JavaScript -->
              <div style="display: none;">
                <span id="total-fees">4</span>
                <span id="approved-fees">4</span>
                <span id="total-amount">$1000.00</span>
                <span id="approved-amount">$1000.00</span>
                <span id="repo-match-count">0</span>
                <span id="preapproved-match-count">4</span>
                <span id="unmatched-count">0</span>
              </div>
  
              
              
              <div class="row mt-4" id="predefined-fees-section" style="display: block;">
                <div class="col-12">
                  <h5>Predefined Categories Fees</h5>
                  <div class="table-responsive">
                    <table class="table table-striped table-hover">
                      <thead class="table-dark">
                        <tr>
                          <th>Date</th>
                          <th>Category</th>
                          <th>Amount</th>
                          <th>Status</th>
                          <th>Source</th>
                          <th>Reference Sentence</th>
                        </tr>
                      </thead>
                      <tbody id="predefined-fees-table-body"><tr><td><span style="font-weight: bold;">25-04-28</span></td><td>Other</td><td>$250.00</td><td><span class="badge bg-success">Approved</span></td><td><span class="tab-source my-summary-source">My Summary</span></td><td style="max-width: 300px; overflow-wrap: break-word;"><div class="ref-text" title="Keys Fee: Details
                                    A new fee request has been submitted on case ID 2168756721
  
  The fee request is for Key Fee in the amount of $250.00">Keys Fee: Details
                                    A new fee request has been submitted on case ID 2168...</div></td></tr><tr><td><span style="font-weight: bold;">25-04-28</span></td><td>Other</td><td>$250.00</td><td><span class="badge bg-success">Approved</span></td><td><span class="tab-source my-summary-source">My Summary</span></td><td style="max-width: 300px; overflow-wrap: break-word;"><div class="ref-text" title="Keys Fee: A new fee request has been submitted on case ID 2168756721
  
  The fee request is for Key Fee in the amount of $250.00">Keys Fee: A new fee request has been submitted on case ID 2168756721
  
  The fee re...</div></td></tr><tr><td><span style="font-weight: bold;">05/12/2025</span></td><td>Other</td><td>$250.00</td><td><span class="badge bg-success">Approved</span></td><td><span class="tab-source updates-source">Updates</span></td><td style="max-width: 300px; overflow-wrap: break-word;"><div class="ref-text" title="Keys Fee: est has been submitted on case ID 2168756721
  
  The fee request is for Key Fee in the amount of $250.00</span></dd>
                                    </div>
                              </div>">Keys Fee: est has been submitted on case ID 2168756721
  
  The fee request is for K...</div></td></tr><tr><td><span style="font-weight: bold;">05/12/2025</span></td><td>Other</td><td>$250.00</td><td><span class="badge bg-success">Approved</span></td><td><span class="tab-source updates-source">Updates</span></td><td style="max-width: 300px; overflow-wrap: break-word;"><div class="ref-text" title="Keys Fee: The fee request is for Key Fee in the amount of $250.00</span></dd>
                                    </div>
                              </div>">Keys Fee: The fee request is for Key Fee in the amount of $250.00
          ...</div></td></tr></tbody>
                    </table>
                  </div>
                </div>
              </div>
              
              <div class="row mt-4" id="additional-fees-section" style="display: none;">
                <div class="col-12">
                  <h5>Additional Fees</h5>
                  <div class="table-responsive">
                    <table class="table table-striped table-hover">
                      <thead class="table-primary">
                        <tr>
                          <th>Date</th>
                          <th>Amount</th>
                          <th>Status</th>
                          <th>Source</th>
                          <th>Reference Sentence</th>
                        </tr>
                      </thead>
                      <tbody id="additional-fees-table-body">
                        <!-- Additional fees will be added dynamically -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
              
              <div class="row mt-4">
                <div class="col-12">
                  <div class="d-flex justify-content-between">
                    <h5>Download Results</h5>
                  </div>
                  <div class="btn-group mt-2" id="download-links"><a href="/downloads/all-updates-2168756721-2025-05-12-16-41-28.json" class="btn btn-primary me-2" download="all-updates-2168756721-2025-05-12-16-41-28.json">Raw Updates (JSON)</a><a href="/downloads/my-summary-fees-2168756721-2025-05-12-16-41-28.json" class="btn btn-primary me-2" download="my-summary-fees-2168756721-2025-05-12-16-41-28.json">My Summary Fees (JSON)</a><a href="/downloads/fee-table-2168756721-2025-05-12-16-41-28.json" class="btn btn-primary me-2" download="fee-table-2168756721-2025-05-12-16-41-28.json">Fee Table (JSON)</a><a href="/downloads/report-2168756721-2025-05-12-16-41-28.html" class="btn btn-primary me-2" download="report-2168756721-2025-05-12-16-41-28.html">HTML Report</a></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="/js/dashboard.js"></script>
  
  </body></html>